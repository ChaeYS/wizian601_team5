<!DOCTYPE html>
<html lang="ko" xmlns:th="http://thymeleaf.org">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>중앙대학교 상담센터</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
        <link href="css/mypage.css" rel="stylesheet" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        
		<style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            line-height: 1.6;
        }

        #sidenav {
            background: #B6B6B6;
            /* color: #fff; */
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
            float: left;
            margin-right: 20px;
            padding: 10px;
            margin-top: 40px;
            width: 200px;
            height: auto;
            text-align: center;
        }

        .button {
            margin-bottom: 30px;
            color: white;
            font-size: 15pt;
            width: 140px;
            height: 35px;
            background-color: #A41034;
            border: none;
            transition: background-color 0.3s ease;
        }

        .button:hover {
            background-color: #004494;
            cursor: pointer;
        }

        #content {
            background: #ffffff;
            float: left;
            padding: 20px;
            margin-top: 40px;
            width: 1000px;
            height: 780px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            font-family: Arial, sans-serif;
            overflow-y: auto;
        }

        .form-control {
            border-radius: 5px;
            border: 1px solid #ced4da;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            font-weight: 600;
        }

        @media (max-width: 768px) {
            #sidenav, #content {
                width: 100%;
                margin-top: 20px;
                float: none;
            }
        }
    </style>
    </head>
    <body>
        <!-- 메뉴-->
        <div th:insert="~{menu :: Menu}"></div>
        
        <!-- Page Content-->
        <div class="container px-4 px-lg-5">
        <div class="d-flex justify-content-center">
        
	        <div id="sidenav">
				<p style="margin-top:20px; margin-bottom:80px; font-weight:bold; font-size:20pt;">마이페이지</p>
				<form th:action="@{/mypage}" >
					<button class="button" type="submit">내 정보</button><br>
            	</form>
				<button class="button" type="submit" onclick="openPage('/psycoun_type')"></button><br>
				<button class="button" type="submit" onclick="openPage('/psycoun_app')"></button>
			</div>
        	
        	<div id="content">
        		<!-- <div>
        			<input type="text" class="form-control" id="phoneNum" placeholder="John" th:value="${selectMyInfo.get('STUD_NM')}" required>
        		</div> -->
        		<div class="form-group row">
                      <label for="empName" class="col-sm-3 col-form-label">
                          이 름
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="STUD_NM" th:value="${selectMyInfo.get('STUD_NM')}" readonly>
                          <!-- 로그인한 session값 가져오기
                          <input type="text" class="form-control" id="empName" placeholder="John" value="${session.user.name}" required>
                           -->
                      </div>
                      <label for="empCounName" class="col-sm-3 col-form-label">
                          지도교수
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="PF_NM" th:value="${selectMyInfo.get('PF_NM')}" readonly>
                          <!-- <input type="hidden" id="CSL_NO" name="CSL_NO" th:value="${selectEmpCoun['CSL_NO']}"/> -->
                      </div>
                  </div>
        		<div class="form-group row">
                      <label for="empName" class="col-sm-3 col-form-label">
                          이 메 일
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="STUD_EML_ADDR" th:value="${selectMyInfo.get('STUD_EML_ADDR')}" required>
                          <!-- 로그인한 session값 가져오기
                          <input type="text" class="form-control" id="empName" placeholder="John" value="${session.user.name}" required>
                           -->
                      </div>
                      <label for="empCounName" class="col-sm-3 col-form-label">
                          지도교수 메일
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="PF_EMAIL" th:value="${selectMyInfo.get('PF_EMAIL')}" readonly>
                          <!-- <input type="hidden" id="CSL_NO" name="CSL_NO" th:value="${selectEmpCoun['CSL_NO']}"/> -->
                      </div>
                  </div>
        		<div class="form-group row">
                      <label for="empName" class="col-sm-3 col-form-label">
                          전화번호
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="TELNO" th:value="${selectMyInfo.get('TELNO')}" required>
                          <!-- 로그인한 session값 가져오기
                          <input type="text" class="form-control" id="empName" placeholder="John" value="${session.user.name}" required>
                           -->
                      </div>
                      <label for="empCounName" class="col-sm-3 col-form-label">
                          지도교수 전화번호
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="STUD_NM" th:value="${selectMyInfo.get('STUD_NM')}" readonly>
                          <!-- <input type="hidden" id="CSL_NO" name="CSL_NO" th:value="${selectEmpCoun['CSL_NO']}"/> -->
                      </div>
                  </div>
        		<div class="form-group row">
                      <label for="empName" class="col-sm-3 col-form-label">
                          학 과
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="SCSBJT_NM" th:value="${selectMyInfo.get('SCSBJT_NM')}" readonly>
                          <!-- 로그인한 session값 가져오기
                          <input type="text" class="form-control" id="empName" placeholder="John" value="${session.user.name}" required>
                           -->
                      </div>
                      <label for="empCounName" class="col-sm-3 col-form-label">
                          학 번
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="STUD_NO" th:value="${selectMyInfo.get('STUD_NO')}" readonly>
                          <!-- <input type="hidden" id="CSL_NO" name="CSL_NO" th:value="${selectEmpCoun['CSL_NO']}"/> -->
                      </div>
                  </div>
        		<div class="form-group row">
                      <label for="empName" class="col-sm-3 col-form-label">
                          생 년 월 일
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="STUD_BRDT" th:value="${selectMyInfo.get('STUD_BRDT')}" readonly>
                          <!-- 로그인한 session값 가져오기
                          <input type="text" class="form-control" id="empName" placeholder="John" value="${session.user.name}" required>
                           -->
                      </div>
                      <label for="empCounName" class="col-sm-3 col-form-label">
                          성 별
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="STUD_GEN" th:value="${selectMyInfo.get('STUD_GEN')}" required>
                          <!-- <input type="hidden" id="CSL_NO" name="CSL_NO" th:value="${selectEmpCoun['CSL_NO']}"/> -->
                      </div>
                  </div>
        		<div class="form-group row">
                      <label for="empName" class="col-sm-3 col-form-label">
                          학 적 상 태
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="COL_REG" th:value="${selectMyInfo.get('COL_REG')}" readonly>
                          <!-- 로그인한 session값 가져오기
                          <input type="text" class="form-control" id="empName" placeholder="John" value="${session.user.name}" required>
                           -->
                      </div>
                      <label for="empCounName" class="col-sm-3 col-form-label">
                          국 가 명
                      </label>
                      <div class="col-sm-3">
                          <input type="text" class="form-control" id="NTN_NM" th:value="${selectMyInfo.get('NTN_NM')}" readonly>
                          <!-- <input type="hidden" id="CSL_NO" name="CSL_NO" th:value="${selectEmpCoun['CSL_NO']}"/> -->
                      </div>
                  </div>
        	</div>
        	<script type="text/javascript">
		    // 로그인한 사람 정보 값이 바뀌면 db에 update되게하기 
// 값이 변경될 때마다 해당 함수를 호출하도록 설정
$('#STUD_EML_ADDR').change(function() {
	var valueEml = $(this).val();
	alert(valueEml);
	$.ajax({
        type: "POST",
        url: "/updateMyInfoEml",
        contentType: "text/plain", // 올바른 MIME 타입 설정
        data: valueEml,
        success: function(response) {
            console.log("Response from server: " + response);
        },
        error: function(xhr, status, error) {
            console.error("Error sending data to server: " + error);
        }
    });
});
$('#TELNO').change(function() {
	var valueTel = $(this).val();
	
	// 숫자만 입력되었는지 검사
    if (!validateMobile(valueTel)) {
        alert("숫자만 입력해주세요.");
        return;
    }

    // 숫자만 입력 유효성 검사 함수
    function validateMobile(valueTel) {
        var re = /^\d+$/;
        return re.test(valueTel);
    }
	
	alert(valueTel);
	$.ajax({
        type: "POST",
        url: "/updateMyInfoTel",
        contentType: "text/plain", // 올바른 MIME 타입 설정
        data: valueEml,
        success: function(response) {
            console.log("Response from server: " + response);
        },
        error: function(xhr, status, error) {
            console.error("Error sending data to server: " + error);
        }
    });
});
$('#STUD_GEN').change(function() {
	var valueGen = $(this).val();
	alert(valueGen);
	$.ajax({
        type: "POST",
        url: "/updateMyInfoGen",
        contentType: "text/plain", // 올바른 MIME 타입 설정
        data: valueEml,
        success: function(response) {
            console.log("Response from server: " + response);
        },
        error: function(xhr, status, error) {
            console.error("Error sending data to server: " + error);
        }
    });
});
		</script>

        	
        </div>
        
        </div>
        
        <!-- 푸터-->
        <div class="container px-4 px-lg-5 fixed-bottom" th:replace="footer :: Footer"> -->
        <!-- <div class="container px-4 px-lg-5" th:insert="~{footer :: Footer}"> -->
        </div>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>
